(self.AMP = self.AMP || []).push({n:"amp-anim", f:(function(AMP) {var h;function k(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};Date.now();self.log=self.log||{user:null,dev:null};var l=self.log;function m(){if(l.user)return l.user;throw Error("failed to call initLogConstructor");};var n,p="Webkit webkit Moz moz ms O o".split(" ");function q(a){var b=void 0;n||(n=Object.create(null));var c=n.display;if(!c||b){c="display";if(void 0===a.display){var d="D"+"display".slice(1);a:{for(var e=0;e<p.length;e++){var g=p[e]+d;if(void 0!==a[g]){d=g;break a}}d=""}var f=d;void 0!==a[f]&&(c=f)}b||(n.display=c)}return c}function r(a,b){if(void 0===b){var c;c=(c=q(a.style))?a.style[c]:void 0;b="none"==c}c=b?"":"none";var d=q(a.style);d&&(a.style[d]=c)};function t(a){m().assert(0<a.length,"Srcset must have at least one source");this.a=a;var b=!1,c=!1;for(a=0;a<this.a.length;a++){var d=this.a[a];m().assert((d.width||d.dpr)&&(!d.width||!d.dpr),"Either dpr or width must be specified");b=b||!!d.width;c=c||!!d.dpr}m().assert(!b||!c,"Srcset cannot have both width and dpr sources");b?this.a.sort(u):this.a.sort(v);this.h=b;this.g=c}
t.prototype.select=function(a,b){var c=-1;if(this.h)for(var c=-1,d=1E6,e=1E6,g=0;g<this.a.length;g++){var f=this.a[g],f=f.width?f.width/b:d/2,d=Math.min(d,f),f=Math.abs((f-a)/a-.2);f<e&&(e=f,c=g)}else if(this.g){a=-1;c=1E6;for(d=0;d<this.a.length;d++)e=Math.abs((this.a[d].dpr||1)-b),e<c&&(c=e,a=d);c=a}return-1!=c?this.a[c]:this.getLast()};t.prototype.getLast=function(){return this.a[this.a.length-1]};t.prototype.getSources=function(){return this.a};
t.prototype.stringify=function(){for(var a=[],b=0;b<this.a.length;b++){var c=this.a[b];c.width?a.push(c.url+" "+c.width+"w"):c.dpr?a.push(c.url+" "+c.dpr+"x"):a.push(""+c.url)}return a.join(", ")};function u(a,b){m().assert(a.width!=b.width,"Duplicate width: %s",a.width);return b.width-a.width}function v(a,b){m().assert(a.dpr!=b.dpr,"Duplicate dpr: %s",a.dpr);return b.dpr-a.dpr};function w(a){AMP.BaseElement.call(this,a);this.b=new Image;this.c=this.f=null}k(w,AMP.BaseElement);h=w.prototype;h.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a};
h.buildCallback=function(){this.propagateAttributes(["alt","aria-label","aria-describedby","aria-labelledby"],this.b);this.applyFillContent(this.b,!0);"img"==this.element.getAttribute("role")&&(this.element.removeAttribute("role"),m().error("AMP-ANIM","Setting role=img on amp-anim elements breaks screen readers. Please just set alt or ARIA attributes, they will be correctly propagated for the underlying <img> element."));r(this.b,!this.getPlaceholder());this.element.appendChild(this.b);var a;a=this.element;
var b=a.getAttribute("srcset");if(b){a=b.match(/\s*(?:[\S]*)(?:\s+(?:-?(?:\d+(?:\.(?:\d+)?)?|\.\d+)[a-zA-Z]))?(?:\s*,)?/g);m().assert(0<a.length,"srcset has to have at least one source: %s",void 0);for(var b=[],c=0;c<a.length;c++){var d=a[c].trim();","==d.substr(-1)&&(d=d.substr(0,d.length-1).trim());var e=d.split(/\s+/,2);if(0!=e.length&&(1!=e.length||e[0])&&(2!=e.length||e[0]||e[1]))if(d=e[0],1==e.length||2==e.length&&!e[1])b.push({url:d,width:void 0,dpr:1});else{var e=e[1].toLowerCase(),g=e.substring(e.length-
1);"w"==g?b.push({url:d,width:parseFloat(e),dpr:void 0}):"x"==g&&b.push({url:d,width:void 0,dpr:parseFloat(e)})}}a=new t(b)}else a=m().assert(a.getAttribute("src"),'Either non-empty "srcset" or "src" attribute must be specified: %s',a),a=new t([{url:a,width:void 0,dpr:1}]);this.f=a};h.isRelayoutNeeded=function(){return!0};h.layoutCallback=function(){return x(this)};h.firstLayoutCompleted=function(){};h.viewportCallback=function(a){var b=this;a&&this.c?this.c.then(function(){return y(b)}):y(this)};
h.unlayoutCallback=function(){this.b.src="";return!0};function y(a){var b=a.isInViewport();a.togglePlaceholder(!b);r(a.b,b)}function x(a){if(0>=a.getLayoutWidth())return Promise.resolve();var b=a.f.select(a.getLayoutWidth(),a.getDpr()).url;if(b==a.b.getAttribute("src"))return Promise.resolve();a.b.setAttribute("src",b);a.c=a.loadPromise(a.b).catch(function(b){if(a.b.getAttribute("src"))throw b;});return a.c}AMP.registerElement("amp-anim",w);
})});
//# sourceMappingURL=amp-anim-0.1.js.map

