(self.AMP = self.AMP || []).push({n:"amp-fresh", f:(function(AMP) {function h(a,b){function e(){}e.prototype=b.prototype;a.prototype=new e;a.prototype.constructor=a;for(var f in b)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,f);d&&Object.defineProperty(a,f,d)}else a[f]=b[f]};Date.now();self.log=self.log||{user:null,dev:null};var k=self.log;function n(){if(k.user)return k.user;throw Error("failed to call initLogConstructor");};function p(a){a=a.__AMP_TOP||a;var b=a.services&&a.services.xhr&&a.services.xhr.obj;return b}function q(a){if(a.nodeType){var b=(a.ownerDocument||a).defaultView,b=b.__AMP_TOP||b;a=r(b,b,"ampdoc").getAmpDoc(a)}return a}function r(a,b,e,f){var d=a,c=d.services;c||(c=d.services={});var g=c;(d=g[e])||(d=g[e]={obj:null,promise:null,resolve:null});d.obj||(d.obj=f?new f(b):(void 0)(b),d.resolve&&d.resolve(d.obj));return d.obj};function t(a){var b=String(Date.now()),b=encodeURIComponent("amp-fresh")+"="+encodeURIComponent(b);if(b){a=a.split("#",2);var e=a[0].split("?",2),b=e[0]+(e[1]?"?"+e[1]+"&"+b:"?"+b),b=b+(a[1]?"#"+a[1]:"")}else b=a;return b};var u;
function v(a){var b="amp-fresh",e=u||(u=Object.create(null)),f;if(b in e)f=e[b];else{f=b;var d=b,c;if(a._experimentCookie)c=a._experimentCookie;else{c:{d:{try{c=a.document.cookie;break d}catch(B){}c=void 0}if(c){c=c.split(";");for(var g=0;g<c.length;g++){var l=c[g].trim(),m=l.indexOf("=");if(-1!=m&&"AMP_EXP"==decodeURIComponent(l.substring(0,m).trim())){c=decodeURIComponent(l.substring(m+1).trim());break c}}}c=null}c=a._experimentCookie=c?c.split(/\s*,\s*/g):[]}a=-1!=c.indexOf(d)?!0:a.AMP_CONFIG&&a.AMP_CONFIG.hasOwnProperty(d)?
Math.random()<a.AMP_CONFIG[d]:!1;f=e[f]=a}return f};function w(a){var b=this;this.ampdoc=a;v(this.ampdoc.win)&&(this.a=Object.create(null),this.g=x(this).then(function(a){y(b,a)}).catch(function(){z(b)}))}w.prototype.register=function(a,b){n().assert(!this.a[a],"duplicate amp-fresh id used: "+a);this.a[a]=b};function x(a){var b=t(a.ampdoc.win.location.href);return Promise.all([p(a.ampdoc.win).fetchDocument(b),a.ampdoc.whenReady()]).then(function(a){return a[0]})}
function y(a,b){Object.keys(a.a).forEach(function(e){var f=b.getElementById(e);if(f){var d=a.a[e];d.update(n().assertElement(f))}})}function z(a){n().error("AMP-FRESH","Failed fetching fresh document through amp-fresh");a.ampdoc.whenReady().then(function(){Object.keys(a.a).forEach(function(b){a.a[b].setFreshReady()})})};function A(a){AMP.BaseElement.call(this,a);this.c=!1;this.b="";this.f=null}h(A,AMP.BaseElement);A.prototype.isLayoutSupported=function(){return!0};A.prototype.buildCallback=function(){this.c=v(this.win);n().assert(this.c,"Experiment amp-fresh disabled");this.b=n().assert(this.element.getAttribute("id"),"amp-fresh must have an id.");var a=q(this.element),b;b=q(a);b=b.isSingleDoc()?b.win:b;this.f=r(b,a,"ampFreshManager",w);this.f.register(this.b,this)};
A.prototype.update=function(a){var b=this,e=this.win.document.adoptNode(a);this.mutateElement(function(){b.element.textContent="";for(var a=b.element,d=a.ownerDocument.createDocumentFragment(),c=e.firstChild;c;c=c.nextSibling)d.appendChild(c.cloneNode(!0));a.appendChild(d);b.setFreshReady()})};A.prototype.setFreshReady=function(){this.element.classList.add("amp-fresh-ready")};AMP.registerElement("amp-fresh",A,"amp-fresh.amp-fresh-ready{visibility:visible}\n/*# sourceURL=/extensions/amp-fresh/0.1/amp-fresh.css*/");
})});
//# sourceMappingURL=amp-fresh-0.1.js.map

