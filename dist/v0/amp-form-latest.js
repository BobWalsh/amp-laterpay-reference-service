(self.AMP = self.AMP || []).push({n:"amp-form", f:(function(AMP) {var h;function m(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};Date.now();function n(a){for(var b=null,c="",d=0;d<arguments.length;d++){var e=arguments[d];e instanceof Error&&!b?b=e:(c&&(c+=" "),c+=e)}b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function aa(a){var b=n.apply(null,arguments);setTimeout(function(){throw b;})}self.log=self.log||{user:null,dev:null};var p=self.log;function q(){if(p.user)return p.user;throw Error("failed to call initLogConstructor");};function r(a){if(!a)return[];for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c];return b};function ba(a,b,c){if(b(a))c();else{var d=a.ownerDocument.defaultView;if(d.MutationObserver){var e=new d.MutationObserver(function(){b(a)&&(e.disconnect(),c())});e.observe(a,{childList:!0})}else var f=d.setInterval(function(){b(a)&&(d.clearInterval(f),c())},5)}}function ca(a,b){ba(a.documentElement,function(){return!!a.body},b)}function da(a){return new Promise(function(b){ca(a,b)})}function ea(a,b){for(var c=a.firstElementChild;c;c=c.nextElementSibling)if(b(c))return c;return null}var t;
function fa(a){if(null==t)try{a.ownerDocument.querySelector(":scope"),t=!0}catch(b){t=!1}return t?a.querySelector(":scope > [i-amp-rendered]"):ea(a,function(a){return a.hasAttribute("i-amp-rendered")})}function ga(a,b){for(var c=[],d=a.parentElement;d;d=d.parentElement)b(d)&&c.push(d);return c}function u(a){var b="fieldset",b=b.toUpperCase();return ga(a,function(a){return a.tagName==b})};function v(a,b){a=a.__AMP_TOP||a;var c=a.services&&a.services[b]&&a.services[b].obj;return c}function w(a,b){var c=a,c=c.nodeType?x((c.ownerDocument||c).defaultView,"ampdoc").getAmpDoc(c):c,d=c.isSingleDoc()?c.win:c;return d&&d.services&&d.services[b]&&d.services[b].obj}function x(a,b,c){var d=a=a.__AMP_TOP||a,e=c?c:void 0;a=y(a);var f=a[b];f||(f=a[b]={obj:null,promise:null,resolve:null});f.obj||(f.obj=e(d),f.resolve&&f.resolve(f.obj));return f.obj}
function z(a){var b=A(a);if(b)return b;a=y(a);var c,d=new Promise(function(a){c=a});a["amp-analytics-instrumentation"]={obj:null,promise:d,resolve:c};return d}function A(a){if(a=y(a)["amp-analytics-instrumentation"]){var b=a.promise;if(b)return b;if(a.obj)return a.promise=Promise.resolve(a.obj)}return null}function y(a){var b=a.services;b||(b=a.services={});return b};function ha(a){var b=A(a);return b?b:Promise.resolve().then(function(){return a.ampExtendedElements&&a.ampExtendedElements["amp-analytics"]?z(a):da(a.document).then(function(){return a.ampExtendedElements&&a.ampExtendedElements["amp-analytics"]?z(a):null})})};var ia=/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org/;var B,C;
function E(a){var b;B||(B=self.document.createElement("a"),C=self.UrlCache||(self.UrlCache=Object.create(null)));var c=C[a];if(c)return c;B.href=a;B.protocol||(B.href=B.href);var d={href:B.href,protocol:B.protocol,host:B.host,hostname:B.hostname,port:"0"==B.port?"":B.port,pathname:B.pathname,search:B.search,hash:B.hash,origin:null};"/"!==d.pathname[0]&&(d.pathname="/"+d.pathname);if("http:"==d.protocol&&80==d.port||"https:"==d.protocol&&443==d.port)d.port="",d.host=d.hostname;d.origin=B.origin&&"null"!=
B.origin?B.origin:"data:"!=d.protocol&&d.host?d.protocol+"//"+d.host:d.href;var e=d;return b?e:C[a]=e}function ja(a,b){var c=[],d;for(d in b){var e=b[d];if(null!=e)if(Array.isArray(e))for(var f=0;f<e.length;f++){var g=e[f];c.push(encodeURIComponent(d)+"="+encodeURIComponent(g))}else c.push(encodeURIComponent(d)+"="+encodeURIComponent(e))}if(b=c.join("&"))a=a.split("#",2),c=a[0].split("?",2),b=c[0]+(c[1]?"?"+c[1]+"&"+b:"?"+b),a=b+=a[1]?"#"+a[1]:"";return a}
function ka(a){"string"==typeof a&&(a=E(a));var b;(b="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,b=a.length-10,b=0<=b&&a.indexOf(".localhost",b)==b);return b}function la(a){"string"==typeof a&&(a=E(a));return ia.test(a.origin)};var F;var G,H="Webkit webkit Moz moz ms O o".split(" ");function I(a,b){for(var c in b){var d=a,e=b[c],f;f=d.style;var g=c;G||(G=Object.create(null));var k=G[g];if(!k){k=g;if(void 0===f[g]){var l;l=g;l=l.charAt(0).toUpperCase()+l.slice(1);a:{for(var D=0;D<H.length;D++){var T=H[D]+l;if(void 0!==f[T]){l=T;break a}}l=""}void 0!==f[l]&&(k=l)}G[g]=k}(f=k)&&(d.style[f]=e)}};function ma(a,b){var c,d,e="form.amp-form-submit-error [submit-error],form.amp-form-submit-success [submit-success]{display:block}.-amp-validation-bubble{-webkit-transform:translate(-50%,-100%);transform:translate(-50%,-100%);background-color:#fff;box-shadow:0 5px 15px 0 rgba(0,0,0,.5);max-width:200px;position:absolute;display:none;box-sizing:border-box;padding:10px;border-radius:5px}.-amp-validation-bubble:after{content:' ';position:absolute;bottom:-8px;left:30px;width:0;height:0;border-left:8px solid transparent;border-right:8px solid transparent;border-top:8px solid #fff}[visible-when-invalid]{display:none;color:red}[visible-when-invalid].visible{display:initial}\n/*# sourceURL=/extensions/amp-form/0.1/amp-form.css*/",
f=na(a,a.head,e,c||!1,d||null);if(J(a,f))b();else var g=setInterval(function(){J(a,f)&&(clearInterval(g),b())},4)}function na(a,b,c,d,e){a=a.createElement("style");a.textContent=c;var f=null;d?(a.setAttribute("amp-runtime",""),b.runtimeStyleElement=a):"amp-custom"==e?(a.setAttribute("amp-custom",""),f=b.lastChild):(a.setAttribute("amp-extension",e||""),f=b.runtimeStyleElement);c=b;var g=f;g?g.nextSibling?c.insertBefore(a,g.nextSibling):c.appendChild(a):c.insertBefore(a,c.firstChild);return a}
function J(a,b){var c=a.styleSheets;for(a=0;a<c.length;a++){var d=c[a];if(d.ownerNode==b)return!0}return!1};function oa(a){return"loading"!=a.readyState&&"uninitialized"!=a.readyState}function pa(a,b){qa(a,b)}function qa(a,b){var c=oa,d=c(a);if(d)b(a);else{var e=function(){c(a)&&(d||(d=!0,b(a)),a.removeEventListener("readystatechange",e))};a.addEventListener("readystatechange",e)}};function K(a,b){var c=void 0;ha(a).then(function(a){a&&a.triggerEvent(b,c)})};function L(a,b){this.v=b;this.G=w(a.document,"viewport");this.m=v(a,"vsync");this.u=null;this.s="";this.j=!1;this.f=a.document.createElement("div");this.f.classList.add("-amp-validation-bubble");this.f.__BUBBLE_OBJ=this;a.document.body.appendChild(this.f)}L.prototype.isActiveOn=function(a){return this.j&&a==this.u};L.prototype.hide=function(){this.j&&(this.j=!1,this.u=null,this.s="",this.m.run({measure:void 0,mutate:ra},{bubbleElement:this.f}))};
L.prototype.show=function(a,b){if(!this.isActiveOn(a)||b!=this.s){this.j=!0;this.u=a;this.s=b;var c={message:b,targetElement:a,bubbleElement:this.f,viewport:this.G,id:this.v};this.m.run({measure:sa,mutate:ta},c)}};function ra(a){a.bubbleElement.removeAttribute("aria-alert");a.bubbleElement.removeAttribute("role");for(var b=a.bubbleElement;b.firstChild;)b.removeChild(b.firstChild);I(a.bubbleElement,{display:"none"})}function sa(a){a.targetRect=a.viewport.getLayoutRect(a.targetElement)}
function ta(a){for(var b=a.bubbleElement;b.firstChild;)b.removeChild(b.firstChild);var c=a.bubbleElement.ownerDocument.createElement("div");c.id="bubble-message-"+a.id;c.textContent=a.message;a.bubbleElement.setAttribute("aria-labeledby",c.id);a.bubbleElement.setAttribute("role","alert");a.bubbleElement.setAttribute("aria-live","assertive");a.bubbleElement.appendChild(c);I(a.bubbleElement,{display:"block",top:a.targetRect.top-10+"px",left:a.targetRect.left+a.targetRect.width/2+"px"})};var M,ua=0;function N(a){this.form=a;this.doc=a.ownerDocument}N.prototype.report=function(){};N.prototype.onBlur=function(){};N.prototype.onInput=function(){};function O(a){N.apply(this,arguments)}m(O,N);O.prototype.report=function(){this.form.reportValidity()};function P(a){N.call(this,a);a=this.doc.defaultView;var b="amp-validation-bubble-"+ua++;this.h=new L(a,b)}m(P,N);
P.prototype.report=function(){for(var a=this.form.querySelectorAll("input,select,textarea"),b=0;b<a.length;b++)if(!a[b].checkValidity()){a[b].focus();this.h.show(a[b],a[b].validationMessage);break}};P.prototype.onBlur=function(){this.h.hide()};P.prototype.onInput=function(a){var b=a.target;this.h.isActiveOn(b)&&(b.checkValidity()?(b.removeAttribute("aria-invalid"),this.h.hide()):(b.setAttribute("aria-invalid","true"),this.h.show(b,b.validationMessage)))};
function Q(a){N.call(this,a);this.w={};this.i={}}m(Q,N);h=Q.prototype;h.reportInput=function(a){var b;a:{for(b in a.validity)if(a.validity[b])break a;b=null}var c=b;c&&this.showValidationFor(a,c)};h.hideAllValidations=function(){for(var a in this.i){var b=this.doc.getElementById(a);this.hideValidationFor(b)}};h.getValidationFor=function(a,b){if(!a.id)return null;a="[visible-when-invalid="+b+"]"+("[validation-for="+a.id+"]");void 0===this.w[a]&&(this.w[a]=this.doc.querySelector(a));return this.w[a]};
h.showValidationFor=function(a,b){var c=this.getValidationFor(a,b);c&&(c.textContent.trim()||(c.textContent=a.validationMessage),a.setAttribute("aria-invalid","true"),c.classList.add("visible"),this.i[a.id]=c)};h.hideValidationFor=function(a){var b=this.getVisibleValidationFor(a);b&&(a.removeAttribute("aria-invalid"),b.classList.remove("visible"),delete this.i[a.id])};h.getVisibleValidationFor=function(a){return a.id?this.i[a.id]:null};
h.shouldValidateOnInteraction=function(){throw Error("Not Implemented");};h.onInteraction=function(a){a=a.target;var b=this.shouldValidateOnInteraction(a);this.hideValidationFor(a);b&&!a.checkValidity()&&this.reportInput(a)};h.onBlur=function(a){this.onInteraction(a)};h.onInput=function(a){this.onInteraction(a)};function R(a){Q.apply(this,arguments)}m(R,Q);
R.prototype.report=function(){this.hideAllValidations();for(var a=this.form.querySelectorAll("input,select,textarea"),b=0;b<a.length;b++)if(!a[b].checkValidity()){this.reportInput(a[b]);a[b].focus();break}};R.prototype.shouldValidateOnInteraction=function(a){return!!this.getVisibleValidationFor(a)};function S(a){Q.apply(this,arguments)}m(S,Q);
S.prototype.report=function(){this.hideAllValidations();for(var a=null,b=this.form.querySelectorAll("input,select,textarea"),c=0;c<b.length;c++)b[c].checkValidity()||(a=a||b[c],this.reportInput(b[c]));a&&a.focus()};S.prototype.shouldValidateOnInteraction=function(a){return!!this.getVisibleValidationFor(a)};function U(a){Q.apply(this,arguments)}m(U,Q);U.prototype.shouldValidateOnInteraction=function(){return!0};
function va(a){var b=a.ownerDocument.defaultView,c=F||(F=Object.create(null));if("amp-form-custom-validations"in c)c=c["amp-form-custom-validations"];else{var d;if(b._experimentCookie)d=b._experimentCookie;else{c:{d:{try{d=b.document.cookie;break d}catch(l){}d=void 0}if(d){d=d.split(";");for(var e=0;e<d.length;e++){var f=d[e].trim(),g=f.indexOf("=");if(-1!=g&&"AMP_EXP"==decodeURIComponent(f.substring(0,g).trim())){d=decodeURIComponent(f.substring(g+1).trim());break c}}}d=null}d=b._experimentCookie=
d?d.split(/\s*,\s*/g):[]}b=-1!=d.indexOf("amp-form-custom-validations")?!0:b.AMP_CONFIG&&b.AMP_CONFIG.hasOwnProperty("amp-form-custom-validations")?Math.random()<b.AMP_CONFIG["amp-form-custom-validations"]:!1;c=c["amp-form-custom-validations"]=b}if(c){var k=a.getAttribute("custom-validation-reporting");switch(k){case "as-you-go":return new U(a);case "show-all-on-submit":return new S(a);case "show-first-on-submit":return new R(a)}}void 0===M&&(M=!!a.ownerDocument.createElement("form").reportValidity);
return M?new O(a):new P(a)};function V(a,b){this.v=b;this.b=a.ownerDocument.defaultView;this.a=a;this.m=v(this.b,"vsync");this.F=v(this.b,"templates");this.H=v(this.b,"xhr");this.o=w(this.b.document.documentElement,"action");this.l=(this.a.getAttribute("method")||"GET").toUpperCase();this.I=this.a.getAttribute("target");if(this.c=this.a.getAttribute("action-xhr")){a=this.c;b=this.a;var c="action-xhr",c=void 0===c?"source":c;q().assert(null!=a,"%s %s must be available",b,c);q().assert(ka(a)||/^(\/\/)/.test(a),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',
b,c,a);q().assert(!la(this.c),"form action-xhr should not be on AMP CDN: %s",this.a)}this.B=!this.a.hasAttribute("novalidate");this.a.setAttribute("novalidate","");this.B||this.a.setAttribute("amp-novalidate","");this.a.classList.add("-amp-form");var d=this.a.querySelectorAll('[type="submit"]');this.D=r(d);this.g=null;a=this.a.elements;for(b=0;b<a.length;b++)q().assert(!a[b].name||"__amp_source_origin"!=a[b].name,"Illegal input name, %s found: %s","__amp_source_origin",a[b]);this.A=va(this.a);this.o.installActionHandler(this.a,
this.C.bind(this));wa(this)}V.prototype.C=function(a){"submit"==a.method&&W(this)};function wa(a){a.a.addEventListener("submit",function(b){return W(a,b)},!0);a.a.addEventListener("blur",function(b){X(b.target,!0);a.A.onBlur(b)},!0);a.a.addEventListener("input",function(b){X(b.target,!0);a.A.onInput(b)})}
function W(a,b){if("submitting"==a.g)b&&(b.stopImmediatePropagation(),b.preventDefault());else{var c=xa(a.a);if(a.B&&!c)b&&(b.stopImmediatePropagation(),b.preventDefault()),a.m.run({measure:void 0,mutate:ya},{validator:a.A});else if(a.c){b&&b.preventDefault();za(a);Y(a,"submitting");var d="GET"==a.l||"HEAD"==a.l,e=a.c;d&&(e=ja(a.c,Aa(a)));a.H.fetchJson(e,{body:d?void 0:new FormData(a.a),method:a.l,credentials:"include",requireAmpResponseSourceOrigin:!0}).then(function(b){a.o.trigger(a.a,"submit-success",
null);K(a.b,"amp-form-submit-success");Y(a,"submit-success");Z(a,b||{})}).catch(function(b){a.o.trigger(a.a,"submit-error",null);K(a.b,"amp-form-submit-error");Y(a,"submit-error");Z(a,b.responseJson||{});aa("Form submission failed:",b)})}else"POST"==a.l&&(b&&b.preventDefault(),q().assert(!1,"Only XHR based (via action-xhr attribute) submissions are support for POST requests. %s",a.a))}}
function Aa(a){var b={};a=a.a.elements;for(var c=/^(?:input|select|textarea)$/i,d=/^(?:button|image|file|reset)$/i,e=/^(?:checkbox|radio)$/i,f=0;f<a.length;f++){var g=a[f],k;if(k=g.name){a:if(g.disabled)k=!0;else{k=u(g);for(var l=0;l<k.length;l++)if(k[l].disabled){k=!0;break a}k=!1}k=!k}!k||!c.test(g.tagName)||d.test(g.type)||e.test(g.type)&&!g.checked||(void 0===b[g.name]&&(b[g.name]=[]),b[g.name].push(g.value))}return b}
function Y(a,b){var c=a.g;a.a.classList.remove("amp-form-"+c);a.a.classList.add("amp-form-"+b);a.g=b;a.D.forEach(function(a){"submitting"==b?a.setAttribute("disabled",""):a.removeAttribute("disabled")})}
function Z(a,b){var c=a.a.querySelector("["+a.g+"]");if(c){var d="rendered-message-"+a.v;c.setAttribute("role","alert");c.setAttribute("aria-labeledby",d);c.setAttribute("aria-live","assertive");a.F.findAndRenderTemplate(c,b).then(function(a){a.id=d;a.setAttribute("i-amp-rendered","");c.appendChild(a)})}}function za(a){if(a=a.a.querySelector("["+a.g+"]")){var b=fa(a);b&&(a=b,a.parentElement&&a.parentElement.removeChild(a))}}function ya(a){a.validator.report()}
function xa(a){for(var b=a.querySelectorAll("input,select,textarea,fieldset"),c=0;c<b.length;c++)X(b[c]);return X(a)}
function X(a,b){b=void 0===b?!1:b;var c=!1,d=a.classList.contains("user-valid")?"valid":a.classList.contains("user-invalid")?"invalid":"none",e=a.checkValidity();"valid"!=d&&e?(a.classList.add("user-valid"),a.classList.remove("user-invalid"),c="invalid"==d):"invalid"==d||e||(a.classList.add("user-invalid"),a.classList.remove("user-valid"),c=!0);if(a.validity)for(var f in a.validity)a.classList.toggle(f,a.validity[f]);if(b&&c){f=u(a);for(var g=0;g<f.length;g++)X(f[g]);a.form&&X(a.form)}return e}
function Ba(a){pa(a.document,function(a){r(a.forms).forEach(function(a,b){new V(a,"amp-form-"+b)})})}(function(a){return x(a,"amp-form",function(){ma(a.document,function(){Ba(a)});return{}})})(AMP.win);
})});
//# sourceMappingURL=amp-form-0.1.js.map

